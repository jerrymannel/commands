<html>

<head>
	<title>Astronomy Calc</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono:wght@200;300;400;500;600;700&display=swap"
		rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
	<style>
		body {
			font-size: 12px;
			font-family: 'Noto Sans Mono', monospace;
		}

		.copy-container {
			cursor: pointer;
			transition: background-color 0.2s;
		}

		.copy-button {
			opacity: 0;
			transition: opacity 0.2s;
			color: black;
		}

		.copy-container:hover .copy-button {
			opacity: 1;
		}
	</style>
</head>

<body class="p-2">
	<h1 class="text-center">Commands</h1>
	<div class="container-fluid">
		<div class="row">
			<div class="col-2">
				<div class="list-group">
					<button class="list-group-item" onclick="menuClick('utils')">Utils</button>
					<button class="list-group-item" onclick="menuClick('golang')">Golang</button>
					<button class="list-group-item" onclick="menuClick('docker')">Docker</button>
					<button class="list-group-item" onclick="menuClick('kubernetes')">Kubernetes</button>
					<button class="list-group-item" onclick="menuClick('mongodb')">MongoDB</button>
					<button class="list-group-item" onclick="menuClick('elastic')">Elastic</button>
					<button class="list-group-item" onclick="menuClick('jenkins')">Jenkins</button>
					<button class="list-group-item" onclick="menuClick('uninstall')">Uninstall</button>
				</div>
			</div>
			<div class="col-9" id="content">
			</div>
		</div>
	</div>

	<script>
		// DATA
		var commands = {};
		var headers = [];

		// ELEMENTS

		async function fetchReadme(page) {
			const response = await fetch("./commands.json");
			commands = await response.json();
		}

		function menuClick(elementId) {
			const targetElement = document.getElementById(elementId);
			targetElement.scrollIntoView({ behavior: 'smooth' });
		}

		function copyCommand(id, data) {
			let element = document.getElementById(id);
			element.classList.replace('bg-secondary-subtle', 'bg-warning');
			setTimeout(() => {
				element.classList.replace('bg-warning', 'bg-secondary-subtle');
			}, 200);
			navigator.clipboard.writeText(data);
		}

		function generateCommandDisplayWithCopyOption(data) {
			let rand = `e${Math.floor(Math.random() * 1000000)}`;
			let element = document.createElement("div");
			element.classList.add("d-flex");
			element.classList.add("flex-row");
			element.classList.add("justify-content-between");
			element.classList.add("copy-container");
			element.classList.add("font-monospace");
			element.classList.add("bg-secondary-subtle");
			element.classList.add("mb-1");
			element.classList.add("border");
			element.classList.add("border-secondary-subtle");
			element.classList.add("rounded-1");
			element.id = rand;
			element.onclick = () => copyCommand(rand, data);

			let commandElem = document.createElement("div");
			commandElem.classList.add("p-2");
			commandElem.classList.add("flex-grow-1");
			commandElem.innerHTML = data;
			element.appendChild(commandElem);

			let copybutton = document.createElement("div");
			copybutton.classList.add("p-2");
			copybutton.classList.add("fs-5");
			let copyIcon = document.createElement("i");
			copyIcon.classList.add("copy-button");
			copyIcon.classList.add("bi");
			copyIcon.classList.add("bi-clipboard");
			copyIcon.style.width = "100px";
			copybutton.appendChild(copyIcon);

			element.appendChild(copybutton);
			return element
		}

		function populateGeneric(data) {
			let card = document.createElement("div");
			card.classList.add("card");
			card.classList.add("mb-3");
			if (data.id) card.id = data.id;

			if (data.title) {
				let cardHeader = document.createElement("div");
				cardHeader.classList.add("card-header");
				cardHeader.classList.add("fs-5");
				cardHeader.innerHTML = data.title;
				card.appendChild(cardHeader);
			}

			let cardBody = document.createElement("div");
			cardBody.classList.add("card-body");
			if (data.commands)
				data.commands.forEach(cmd => {
					cardBody.appendChild(generateCommandDisplayWithCopyOption(cmd));
				});
			card.appendChild(cardBody);
			if (data.children && data.children.length > 0) {
				data.children.forEach(child => {
					cardBody.appendChild(populateGeneric(this, child));
				});
			}
			return card;
		}

		(async () => {
			await fetchReadme();
			let content = document.getElementById("content");
			commands.forEach(command => {
				content.appendChild(populateGeneric(command));
			});
		})()
	</script>
</body>

</html>